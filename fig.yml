zookeeper:
  image: jplock/zookeeper:3.4.6
  ports:
    - "2181:2181"
kafka1:
  image: alexguev/kafka:0.8.1.1
  ports:
    - "9091:9091"
    - "8888:8888"
  links:
    - zookeeper:zk
    - graphite:graphite
  environment:
    BROKER_ID: 1
    HOST_IP: 192.168.59.104
    PORT: 9091
    GRAPHITE_ENABLED: true
    GRAPHITE_GROUP: kafka1
    KAFKA_JMX_OPTS: -Dcom.sun.management.jmxremote -Djava.rmi.server.hostname=192.168.59.104 -Dcom.sun.management.jmxremote.port=8888 -Dcom.sun.management.jmxremote.rmi.port=8888 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.local.only=false -Dcom.sun.management.jmxremote.ssl=false
kafka2:
  image: alexguev/kafka:0.8.1.1
  ports:
    - "9092:9092"
  links:
    - zookeeper:zk
    - graphite:graphite
  environment:
    BROKER_ID: 2
    HOST_IP: 192.168.59.104
    PORT: 9092
    GRAPHITE_ENABLED: true
    GRAPHITE_GROUP: kafka2
  privileged: true
mysql:
  image: stackbrew/mysql:5.7.4
  ports:
    - "3306:3306"
  environment:
    MYSQL_ROOT_PASSWORD: password
    MYSQL_DATABASE: counters
    MYSQL_USER: counters
    MYSQL_PASSWORD: counters
graphite:
  image: hopsoft/graphite-statsd:latest
  ports:
    - "8881:80"
#    - "2003:2003"
  expose:
    - "2003"
  command: /opt/hopsoft/graphite-statsd/start
  volumes:
#    - /var/lib/boot2docker/data/counters-clj/graphite/storage:/opt/graphite/storage
    - /opt/graphite/storage
    - /opt/graphite/conf
    - /var/log/graphite

#    - /var/lib/boot2docker/data/counters-clj/graphite:/opt/graphite/storage
#
#    -v /var/log/graphite:/var/log \
#	-v /opt/graphite/storage \
#	-v /opt/graphite/conf \

#this will be the main image, it can be scaled with fig scale
#aggregator1:
#  image: stackbrew/java:8
#  links:
#    - mysql1:mysql
